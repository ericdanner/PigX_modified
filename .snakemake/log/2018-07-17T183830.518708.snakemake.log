Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 4
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	all
	2	bbmap_map
	2	fastqc
	2	getIndelStats
	1	multiqc
	2	report
	2	samtools_indexbam
	2	samtools_sam2bam
	2	samtools_stats
	2	trimmomatic
	18

rule trimmomatic:
    input: /home/edanner/workspace/pigx_crispr/sample_data/reads/lin41RNA_pool1_S67_R1_001.fastq.gz
    output: /home/edanner/workspace/pigx_crispr/sample_data/output/trimmed_reads/lin-41/lin41RNA_pool1.fastq.gz
    log: /home/edanner/workspace/pigx_crispr/sample_data/output/logs/lin-41/trimmomatic.lin41RNA_pool1.log
    jobid: 21
    wildcards: amplicon=lin-41, sample=lin41RNA_pool1

trimmomatic SE -threads 2 /home/edanner/workspace/pigx_crispr/sample_data/reads/lin41RNA_pool1_S67_R1_001.fastq.gz /home/edanner/workspace/pigx_crispr/sample_data/output/trimmed_reads/lin-41/lin41RNA_pool1.fastq.gz        ILLUMINACLIP:/home/edanner/workspace/pigx_crispr/sample_data/adapters/TruSeq2-SE.fa:2:30:10 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36 > /home/edanner/workspace/pigx_crispr/sample_data/output/logs/lin-41/trimmomatic.lin41RNA_pool1.log 2>&1

rule fastqc:
    input: /home/edanner/workspace/pigx_crispr/sample_data/reads/phen_dpy-10_N2_16_S31_R1_001.fastq.gz
    output: /home/edanner/workspace/pigx_crispr/sample_data/output/fastqc/dpy-10/phen_dpy-10_N2_16.fastqc.done
    log: /home/edanner/workspace/pigx_crispr/sample_data/output/logs/dpy-10/phen_dpy-10_N2_16.fastqc.log
    jobid: 5
    wildcards: amplicon=dpy-10, sample=phen_dpy-10_N2_16

fastqc -o /home/edanner/workspace/pigx_crispr/sample_data/output/fastqc/dpy-10 /home/edanner/workspace/pigx_crispr/sample_data/reads/phen_dpy-10_N2_16_S31_R1_001.fastq.gz > /home/edanner/workspace/pigx_crispr/sample_data/output/logs/dpy-10/phen_dpy-10_N2_16.fastqc.log 2>&1; touch /home/edanner/workspace/pigx_crispr/sample_data/output/fastqc/dpy-10/phen_dpy-10_N2_16.fastqc.done

rule trimmomatic:
    input: /home/edanner/workspace/pigx_crispr/sample_data/reads/phen_dpy-10_N2_16_S31_R1_001.fastq.gz
    output: /home/edanner/workspace/pigx_crispr/sample_data/output/trimmed_reads/dpy-10/phen_dpy-10_N2_16.fastq.gz
    log: /home/edanner/workspace/pigx_crispr/sample_data/output/logs/dpy-10/trimmomatic.phen_dpy-10_N2_16.log
    jobid: 14
    wildcards: amplicon=dpy-10, sample=phen_dpy-10_N2_16

trimmomatic SE -threads 2 /home/edanner/workspace/pigx_crispr/sample_data/reads/phen_dpy-10_N2_16_S31_R1_001.fastq.gz /home/edanner/workspace/pigx_crispr/sample_data/output/trimmed_reads/dpy-10/phen_dpy-10_N2_16.fastq.gz        ILLUMINACLIP:/home/edanner/workspace/pigx_crispr/sample_data/adapters/TruSeq2-SE.fa:2:30:10 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36 > /home/edanner/workspace/pigx_crispr/sample_data/output/logs/dpy-10/trimmomatic.phen_dpy-10_N2_16.log 2>&1

rule fastqc:
    input: /home/edanner/workspace/pigx_crispr/sample_data/reads/lin41RNA_pool1_S67_R1_001.fastq.gz
    output: /home/edanner/workspace/pigx_crispr/sample_data/output/fastqc/lin-41/lin41RNA_pool1.fastqc.done
    log: /home/edanner/workspace/pigx_crispr/sample_data/output/logs/lin-41/lin41RNA_pool1.fastqc.log
    jobid: 1
    wildcards: amplicon=lin-41, sample=lin41RNA_pool1

fastqc -o /home/edanner/workspace/pigx_crispr/sample_data/output/fastqc/lin-41 /home/edanner/workspace/pigx_crispr/sample_data/reads/lin41RNA_pool1_S67_R1_001.fastq.gz > /home/edanner/workspace/pigx_crispr/sample_data/output/logs/lin-41/lin41RNA_pool1.fastqc.log 2>&1; touch /home/edanner/workspace/pigx_crispr/sample_data/output/fastqc/lin-41/lin41RNA_pool1.fastqc.done
Finished job 21.
1 of 18 steps (6%) done

rule bbmap_map:
    input: /home/edanner/workspace/pigx_crispr/sample_data/output/trimmed_reads/lin-41/lin41RNA_pool1.fastq.gz, /home/edanner/workspace/pigx_crispr/sample_data/output/bbmap_indexes/lin-41
    output: /home/edanner/workspace/pigx_crispr/sample_data/output/aln/lin-41/lin41RNA_pool1.sam
    log: /home/edanner/workspace/pigx_crispr/sample_data/output/logs/lin-41/bbmap_lin41RNA_pool1.log
    jobid: 26
    wildcards: amplicon=lin-41, sample=lin41RNA_pool1

bbmap.sh path=/home/edanner/workspace/pigx_crispr/sample_data/output/bbmap_indexes/lin-41 in=/home/edanner/workspace/pigx_crispr/sample_data/output/trimmed_reads/lin-41/lin41RNA_pool1.fastq.gz outm=/home/edanner/workspace/pigx_crispr/sample_data/output/aln/lin-41/lin41RNA_pool1.sam t=2 sam=1.3 > /home/edanner/workspace/pigx_crispr/sample_data/output/logs/lin-41/bbmap_lin41RNA_pool1.log 2>&1
Finished job 14.
2 of 18 steps (11%) done

rule bbmap_map:
    input: /home/edanner/workspace/pigx_crispr/sample_data/output/trimmed_reads/dpy-10/phen_dpy-10_N2_16.fastq.gz, /home/edanner/workspace/pigx_crispr/sample_data/output/bbmap_indexes/dpy-10
    output: /home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_N2_16.sam
    log: /home/edanner/workspace/pigx_crispr/sample_data/output/logs/dpy-10/bbmap_phen_dpy-10_N2_16.log
    jobid: 25
    wildcards: amplicon=dpy-10, sample=phen_dpy-10_N2_16

bbmap.sh path=/home/edanner/workspace/pigx_crispr/sample_data/output/bbmap_indexes/dpy-10 in=/home/edanner/workspace/pigx_crispr/sample_data/output/trimmed_reads/dpy-10/phen_dpy-10_N2_16.fastq.gz outm=/home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_N2_16.sam t=2 sam=1.3 > /home/edanner/workspace/pigx_crispr/sample_data/output/logs/dpy-10/bbmap_phen_dpy-10_N2_16.log 2>&1
Finished job 1.
3 of 18 steps (17%) done
Finished job 5.
4 of 18 steps (22%) done
Finished job 25.
5 of 18 steps (28%) done

rule samtools_sam2bam:
    input: /home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_N2_16.sam
    output: /home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_N2_16.bam
    log: /home/edanner/workspace/pigx_crispr/sample_data/output/logs/dpy-10/sam2bam_phen_dpy-10_N2_16.log
    jobid: 11
    wildcards: amplicon=dpy-10, sample=phen_dpy-10_N2_16

samtools view -bh /home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_N2_16.sam | samtools sort -o /home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_N2_16.bam > /home/edanner/workspace/pigx_crispr/sample_data/output/logs/dpy-10/sam2bam_phen_dpy-10_N2_16.log 2>&1
Finished job 26.
6 of 18 steps (33%) done

rule samtools_sam2bam:
    input: /home/edanner/workspace/pigx_crispr/sample_data/output/aln/lin-41/lin41RNA_pool1.sam
    output: /home/edanner/workspace/pigx_crispr/sample_data/output/aln/lin-41/lin41RNA_pool1.bam
    log: /home/edanner/workspace/pigx_crispr/sample_data/output/logs/lin-41/sam2bam_lin41RNA_pool1.log
    jobid: 23
    wildcards: amplicon=lin-41, sample=lin41RNA_pool1

samtools view -bh /home/edanner/workspace/pigx_crispr/sample_data/output/aln/lin-41/lin41RNA_pool1.sam | samtools sort -o /home/edanner/workspace/pigx_crispr/sample_data/output/aln/lin-41/lin41RNA_pool1.bam > /home/edanner/workspace/pigx_crispr/sample_data/output/logs/lin-41/sam2bam_lin41RNA_pool1.log 2>&1
Finished job 11.
7 of 18 steps (39%) done

rule samtools_indexbam:
    input: /home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_N2_16.bam
    output: /home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_N2_16.bam.bai
    log: /home/edanner/workspace/pigx_crispr/sample_data/output/logs/dpy-10/samtools_index_phen_dpy-10_N2_16.log
    jobid: 18
    wildcards: amplicon=dpy-10, sample=phen_dpy-10_N2_16

samtools index /home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_N2_16.bam > /home/edanner/workspace/pigx_crispr/sample_data/output/logs/dpy-10/samtools_index_phen_dpy-10_N2_16.log 2>&1

rule samtools_stats:
    input: /home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_N2_16.bam, /home/edanner/workspace/pigx_crispr/sample_data/amplicons/amplicon_dpy-10.fa
    output: /home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_N2_16.samtools.stats.txt
    log: /home/edanner/workspace/pigx_crispr/sample_data/output/logs/dpy-10/samtools_stats.phen_dpy-10_N2_16.log
    jobid: 6
    wildcards: amplicon=dpy-10, sample=phen_dpy-10_N2_16

samtools stats --reference /home/edanner/workspace/pigx_crispr/sample_data/amplicons/amplicon_dpy-10.fa /home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_N2_16.bam > /home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_N2_16.samtools.stats.txt 2> /home/edanner/workspace/pigx_crispr/sample_data/output/logs/dpy-10/samtools_stats.phen_dpy-10_N2_16.log
Finished job 6.
8 of 18 steps (44%) done
Finished job 18.
9 of 18 steps (50%) done

rule getIndelStats:
    input: /home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_N2_16.bam.bai, /home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_N2_16.bam, /home/edanner/workspace/pigx_crispr/sample_data/cutsites/sgRNA_cutsites_dpy-10.txt
    output: /home/edanner/workspace/pigx_crispr/sample_data/output/indels/dpy-10/phen_dpy-10_N2_16.indelScores.bedgraph, /home/edanner/workspace/pigx_crispr/sample_data/output/indels/dpy-10/phen_dpy-10_N2_16.deletionScores.bedgraph, /home/edanner/workspace/pigx_crispr/sample_data/output/indels/dpy-10/phen_dpy-10_N2_16.insertionScores.bedgraph, /home/edanner/workspace/pigx_crispr/sample_data/output/indels/dpy-10/phen_dpy-10_N2_16.coverageStats.tsv, /home/edanner/workspace/pigx_crispr/sample_data/output/indels/dpy-10/phen_dpy-10_N2_16.indel_stats_at_cutsites.tsv, /home/edanner/workspace/pigx_crispr/sample_data/output/indels/dpy-10/phen_dpy-10_N2_16.deletions.bed, /home/edanner/workspace/pigx_crispr/sample_data/output/indels/dpy-10/phen_dpy-10_N2_16.insertions.bed, /home/edanner/workspace/pigx_crispr/sample_data/output/indels/dpy-10/phen_dpy-10_N2_16.indels.unfiltered.tsv
    log: /home/edanner/workspace/pigx_crispr/sample_data/output/logs/dpy-10/getIndelStats_phen_dpy-10_N2_16.log
    jobid: 13
    wildcards: amplicon=dpy-10, sample=phen_dpy-10_N2_16

/home/edanner/anaconda3/bin/Rscript /home/edanner/workspace/pigx_crispr/src/getIndelStats.R /home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_N2_16.bam phen_dpy-10_N2_16 /home/edanner/workspace/pigx_crispr/sample_data/output/indels/dpy-10 /home/edanner/workspace/pigx_crispr/sample_data/cutsites/sgRNA_cutsites_dpy-10.txt '' > /home/edanner/workspace/pigx_crispr/sample_data/output/logs/dpy-10/getIndelStats_phen_dpy-10_N2_16.log 2>&1
Finished job 23.
10 of 18 steps (56%) done

rule samtools_stats:
    input: /home/edanner/workspace/pigx_crispr/sample_data/output/aln/lin-41/lin41RNA_pool1.bam, /home/edanner/workspace/pigx_crispr/sample_data/amplicons/amplicon_lin-41.fa
    output: /home/edanner/workspace/pigx_crispr/sample_data/output/aln/lin-41/lin41RNA_pool1.samtools.stats.txt
    log: /home/edanner/workspace/pigx_crispr/sample_data/output/logs/lin-41/samtools_stats.lin41RNA_pool1.log
    jobid: 10
    wildcards: amplicon=lin-41, sample=lin41RNA_pool1

samtools stats --reference /home/edanner/workspace/pigx_crispr/sample_data/amplicons/amplicon_lin-41.fa /home/edanner/workspace/pigx_crispr/sample_data/output/aln/lin-41/lin41RNA_pool1.bam > /home/edanner/workspace/pigx_crispr/sample_data/output/aln/lin-41/lin41RNA_pool1.samtools.stats.txt 2> /home/edanner/workspace/pigx_crispr/sample_data/output/logs/lin-41/samtools_stats.lin41RNA_pool1.log

rule samtools_indexbam:
    input: /home/edanner/workspace/pigx_crispr/sample_data/output/aln/lin-41/lin41RNA_pool1.bam
    output: /home/edanner/workspace/pigx_crispr/sample_data/output/aln/lin-41/lin41RNA_pool1.bam.bai
    log: /home/edanner/workspace/pigx_crispr/sample_data/output/logs/lin-41/samtools_index_lin41RNA_pool1.log
    jobid: 3
    wildcards: amplicon=lin-41, sample=lin41RNA_pool1

samtools index /home/edanner/workspace/pigx_crispr/sample_data/output/aln/lin-41/lin41RNA_pool1.bam > /home/edanner/workspace/pigx_crispr/sample_data/output/logs/lin-41/samtools_index_lin41RNA_pool1.log 2>&1
Finished job 10.
11 of 18 steps (61%) done

rule multiqc:
    input: /home/edanner/workspace/pigx_crispr/sample_data/output/fastqc/lin-41/lin41RNA_pool1.fastqc.done, /home/edanner/workspace/pigx_crispr/sample_data/output/fastqc/dpy-10/phen_dpy-10_N2_16.fastqc.done, /home/edanner/workspace/pigx_crispr/sample_data/output/fastqc/dpy-10/phen_dpy-10_sg1sg2_16.fastqc.done, /home/edanner/workspace/pigx_crispr/sample_data/output/trimmed_reads/lin-41/lin41RNA_pool1.fastq.gz, /home/edanner/workspace/pigx_crispr/sample_data/output/trimmed_reads/dpy-10/phen_dpy-10_N2_16.fastq.gz, /home/edanner/workspace/pigx_crispr/sample_data/output/trimmed_reads/dpy-10/phen_dpy-10_sg1sg2_16.fastq.gz, /home/edanner/workspace/pigx_crispr/sample_data/output/aln/lin-41/lin41RNA_pool1.samtools.stats.txt, /home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_N2_16.samtools.stats.txt, /home/edanner/workspace/pigx_crispr/sample_data/output/aln/dpy-10/phen_dpy-10_sg1sg2_16.samtools.stats.txt
    output: /home/edanner/workspace/pigx_crispr/sample_data/output/multiqc/multiqc_report.html
    log: /home/edanner/workspace/pigx_crispr/sample_data/output/logs/multiqc.log
    jobid: 16

multiqc -o /home/edanner/workspace/pigx_crispr/sample_data/output/multiqc /home/edanner/workspace/pigx_crispr/sample_data/output > /home/edanner/workspace/pigx_crispr/sample_data/output/logs/multiqc.log 2>&1
Finished job 3.
12 of 18 steps (67%) done

rule getIndelStats:
    input: /home/edanner/workspace/pigx_crispr/sample_data/output/aln/lin-41/lin41RNA_pool1.bam.bai, /home/edanner/workspace/pigx_crispr/sample_data/output/aln/lin-41/lin41RNA_pool1.bam, /home/edanner/workspace/pigx_crispr/sample_data/cutsites/sgRNA_cutsites_lin-41.txt
    output: /home/edanner/workspace/pigx_crispr/sample_data/output/indels/lin-41/lin41RNA_pool1.indelScores.bedgraph, /home/edanner/workspace/pigx_crispr/sample_data/output/indels/lin-41/lin41RNA_pool1.deletionScores.bedgraph, /home/edanner/workspace/pigx_crispr/sample_data/output/indels/lin-41/lin41RNA_pool1.insertionScores.bedgraph, /home/edanner/workspace/pigx_crispr/sample_data/output/indels/lin-41/lin41RNA_pool1.coverageStats.tsv, /home/edanner/workspace/pigx_crispr/sample_data/output/indels/lin-41/lin41RNA_pool1.indel_stats_at_cutsites.tsv, /home/edanner/workspace/pigx_crispr/sample_data/output/indels/lin-41/lin41RNA_pool1.deletions.bed, /home/edanner/workspace/pigx_crispr/sample_data/output/indels/lin-41/lin41RNA_pool1.insertions.bed, /home/edanner/workspace/pigx_crispr/sample_data/output/indels/lin-41/lin41RNA_pool1.indels.unfiltered.tsv
    log: /home/edanner/workspace/pigx_crispr/sample_data/output/logs/lin-41/getIndelStats_lin41RNA_pool1.log
    jobid: 7
    wildcards: amplicon=lin-41, sample=lin41RNA_pool1

/home/edanner/anaconda3/bin/Rscript /home/edanner/workspace/pigx_crispr/src/getIndelStats.R /home/edanner/workspace/pigx_crispr/sample_data/output/aln/lin-41/lin41RNA_pool1.bam lin41RNA_pool1 /home/edanner/workspace/pigx_crispr/sample_data/output/indels/lin-41 /home/edanner/workspace/pigx_crispr/sample_data/cutsites/sgRNA_cutsites_lin-41.txt lin-41_UTR_sg1:lin-41_UTR_sg4:lin-41_UTR_sg10:lin-41_UTR_sg16:lin-41_UTR_sg22 > /home/edanner/workspace/pigx_crispr/sample_data/output/logs/lin-41/getIndelStats_lin41RNA_pool1.log 2>&1
    Error in rule multiqc:
        jobid: 16
        output: /home/edanner/workspace/pigx_crispr/sample_data/output/multiqc/multiqc_report.html
        log: /home/edanner/workspace/pigx_crispr/sample_data/output/logs/multiqc.log

RuleException:
CalledProcessError in line 164 of /home/edanner/workspace/pigx_crispr/pigx_crispr.py:
Command ' set -euo pipefail;  multiqc -o /home/edanner/workspace/pigx_crispr/sample_data/output/multiqc /home/edanner/workspace/pigx_crispr/sample_data/output > /home/edanner/workspace/pigx_crispr/sample_data/output/logs/multiqc.log 2>&1 ' returned non-zero exit status 1.
  File "/home/edanner/workspace/pigx_crispr/pigx_crispr.py", line 164, in __rule_multiqc
  File "/home/edanner/anaconda3/lib/python3.6/concurrent/futures/thread.py", line 56, in run
Waiting at most 5 seconds for missing files.
MissingOutputException in line 166 of /home/edanner/workspace/pigx_crispr/pigx_crispr.py:
Missing files after 5 seconds:
/home/edanner/workspace/pigx_crispr/sample_data/output/indels/dpy-10/phen_dpy-10_N2_16.indelScores.bedgraph
/home/edanner/workspace/pigx_crispr/sample_data/output/indels/dpy-10/phen_dpy-10_N2_16.deletionScores.bedgraph
/home/edanner/workspace/pigx_crispr/sample_data/output/indels/dpy-10/phen_dpy-10_N2_16.insertionScores.bedgraph
/home/edanner/workspace/pigx_crispr/sample_data/output/indels/dpy-10/phen_dpy-10_N2_16.coverageStats.tsv
/home/edanner/workspace/pigx_crispr/sample_data/output/indels/dpy-10/phen_dpy-10_N2_16.indel_stats_at_cutsites.tsv
/home/edanner/workspace/pigx_crispr/sample_data/output/indels/dpy-10/phen_dpy-10_N2_16.deletions.bed
/home/edanner/workspace/pigx_crispr/sample_data/output/indels/dpy-10/phen_dpy-10_N2_16.insertions.bed
/home/edanner/workspace/pigx_crispr/sample_data/output/indels/dpy-10/phen_dpy-10_N2_16.indels.unfiltered.tsv
This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait.
Waiting at most 5 seconds for missing files.
MissingOutputException in line 166 of /home/edanner/workspace/pigx_crispr/pigx_crispr.py:
Missing files after 5 seconds:
/home/edanner/workspace/pigx_crispr/sample_data/output/indels/lin-41/lin41RNA_pool1.indelScores.bedgraph
/home/edanner/workspace/pigx_crispr/sample_data/output/indels/lin-41/lin41RNA_pool1.deletionScores.bedgraph
/home/edanner/workspace/pigx_crispr/sample_data/output/indels/lin-41/lin41RNA_pool1.insertionScores.bedgraph
/home/edanner/workspace/pigx_crispr/sample_data/output/indels/lin-41/lin41RNA_pool1.coverageStats.tsv
/home/edanner/workspace/pigx_crispr/sample_data/output/indels/lin-41/lin41RNA_pool1.indel_stats_at_cutsites.tsv
/home/edanner/workspace/pigx_crispr/sample_data/output/indels/lin-41/lin41RNA_pool1.deletions.bed
/home/edanner/workspace/pigx_crispr/sample_data/output/indels/lin-41/lin41RNA_pool1.insertions.bed
/home/edanner/workspace/pigx_crispr/sample_data/output/indels/lin-41/lin41RNA_pool1.indels.unfiltered.tsv
This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait.
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /home/edanner/workspace/pigx_crispr/.snakemake/log/2018-07-17T183830.518708.snakemake.log
